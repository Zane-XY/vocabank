@(entries : Iterable[models.Entry])(implicit flash:Flash, token: play.filters.csrf.CSRF.Token)
@import helper._
@main("All Entries") {
<h1>All Entries</h1>
@flash.get("success").map { msg =>
<div class="flash">@msg</div>
}
@if(entries.isEmpty) {
<p>No Entries</p>
} else {

@CSRF.formField

<ul>
@for(e <- entries) {
   <li> <div> @e.title <div class="rating" data-score="@e.rating" data-id="@e.id"></div> <br>
       @e.source, @e.content @e.tags
       <a href="@routes.EntryController.edit(e.id.get)">Edit</a>
       @helper.form(routes.EntryController.delete(e.id.get)){<button type="submit">Delete</button>}
       </div>

   </li>
}
</ul>
}
<a href="@routes.EntryController.add">Add a new entry</a>

<script type="text/javascript">
    $(function() {
         $('div.rating').raty({
              path: '@routes.Assets.at("libs/raty/images")',
              score: function() {
                return $(this).attr('data-score');
              },
              click: function(score, evt) {
                 $.ajax({
                    type: "POST",
                    url:  "/entry/setRating",
                    data: JSON.stringify({ "id": Number($(this).attr('data-id')) , "value": score}),
                    dataType : "json",
                    contentType: "application/json",
                    complete: function (data) {
                        console.log(data);
                    }
                 });
              }
          });
    });
 </script>

<link rel="stylesheet" media="screen" href="@routes.Assets.at("libs/raty/jquery.raty.css")">
<script src="@routes.Assets.at("libs/raty/jquery.raty.js")" type="text/javascript"></script>
}
